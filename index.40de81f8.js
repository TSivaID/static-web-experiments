function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @module logger
 * @version 0.1.0
 * @author T. Siva <t.siva AT outlook.com>
 * @license MIT
 * @description
 * A simple, flexible, and performant logger for use in the browser.
 *
 * The logger provides a way to output messages with different log levels (DEBUG, INFO, WARN, and ERROR)
 * and allows you to include metadata and a thunk function for lazy evaluation of additional information.
 *
 * Thunk functions are useful in scenarios where computing additional information is computationally
 * expensive or time-consuming. By passing a thunk function, the additional information will only be
 * computed when the log level condition is met, avoiding unnecessary computation and improving
 * performance.
 *
 * Usage example:
 * ```
 * import { Logger, LogLevel } from './utils/logger';
 *
 * const logger = new Logger(LogLevel.DEBUG);
 *
 * logger.debug('Debug message');
 * logger.info('Info message', { metadata: { user: 'John Doe' } });
 * logger.warn('Warning message', { metadata: { errorCode: 123 } });
 * logger.error('Error message', { metadata: { error: new Error('Something went wrong') }, thunk: () => ({ additionalInfo: 'lazy evaluated info' }) });
 * ```
 *
 * Usage example with only thunk (without metadata):
 * ```
 * logger.info('Info message', { thunk: () => ({ user: 'John Doe', action: 'lazy evaluated info' }) });
 * ```
 */
/**
 * @module cookie
 * @author T. Siva <t.siva AT outlook.com>
 * @license MIT
 * @description
 * A simple utility module to handle browser cookies with all possible options.
 *
 * Usage example:
 * ```
 * import { setCookie, getCookie, setSessionCookie } from './cookie';
 *
 * setCookie('name', 'John Doe', { maxAge: 3600, path: '/', secure: true });
 * const name = getCookie('name');
 * setSessionCookie('session', '12345');
 * ```
 */function t(e,t,n){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;n&&(void 0!==n.maxAge&&(i+=`; max-age=${n.maxAge}`),n.path&&(i+=`; path=${n.path}`),n.domain&&(i+=`; domain=${n.domain}`),n.secure&&(i+="; secure"),n.sameSite&&(i+=`; samesite=${n.sameSite}`)),document.cookie=i}function n(e){const t=encodeURIComponent(e)+"=",n=document.cookie.split(";");for(const e of n){const n=e.trim();if(n.startsWith(t))return decodeURIComponent(n.slice(t.length))}return null}let i;var s;(s=i||(i={}))[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR";class o{getLogLevel(){return this.logLevel}debug(e,t){this.log(i.DEBUG,e,t)}info(e,t){this.log(i.INFO,e,t)}warn(e,t){this.log(i.WARN,e,t)}error(e,t){this.log(i.ERROR,e,t)}log(e,t,n){if(e>=this.logLevel){let s;const o=e===i.DEBUG?"debug":e===i.INFO?"info":e===i.WARN?"warn":e===i.ERROR?"error":"info";try{const e=n?.metadata?{metadata:{...n.metadata}}:void 0,t=n?.thunk?{thunk:{...n.thunk()}}:void 0;s=e||t?{...e||{},...t||{}}:void 0}catch(e){console.error("Error while logging message",e)}s?console[o](t,s):console[o](t)}}constructor(e){this.logLevel=e}}const r=function(){let e=i.INFO;const s=function(){const e=new URLSearchParams(window.location.search).get("loglevel");if(e){const t=e.toLowerCase();if("debug"===t)return i.DEBUG;if("info"===t)return i.INFO;if("warn"===t)return i.WARN;if("error"===t)return i.ERROR}}();if(void 0!==s)e=s,function(e){t("session_loglevel",e.toString(),{path:"/",sameSite:"strict"})}(e);else{const t=function(){const e=n("session_loglevel");if(e){const t=parseInt(e);if(i[t])return t}}();void 0!==t&&(e=t)}return new o(e)}();class a{initialize(){r.info("MockApiAnalytics initialized")}async trackEvent(e,t){if(!t?.mock_api_analytics)return Promise.resolve();const n={...t.mock_api_analytics,useSendBeacon:this.useSendBeacon};if(this.useSendBeacon&&navigator.sendBeacon){const t=new Blob([JSON.stringify({eventName:e,data:n})],{type:"text/plain;charset=UTF-8"});return navigator.sendBeacon(`${this.endpoint}`,t)?r.info(`MockApiAnalytics sent event using sendBeacon: ${e} with data: ${JSON.stringify(n)}`):r.error(`MockApiAnalytics failed to send event using sendBeacon: ${e}`),Promise.resolve()}try{r.info(`MockApiAnalytics sending event: ${e} with data: ${JSON.stringify(n)}`);const t=await fetch(`${this.endpoint}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventName:e,data:n})});if(!t.ok)return r.error(`MockApiAnalytics failed to track event: ${t.statusText}`),Promise.resolve()}catch(e){return r.error(`MockApiAnalytics failed to track event: ${e.message}`),Promise.resolve()}}constructor(t){e(this,"name","MockApiAnalytics"),e(this,"endpoint","https://web-experiments.autocode.run/static-web-experiments@dev/"),this.useSendBeacon=!0===t?.useSendBeacon}}class c{initialize(){r.info("DummyAnalytics initialized")}async trackEvent(e,t){return t?.dummy_analytics&&r.info(`DummyAnalytics tracked event: ${e} with data: ${JSON.stringify(t.dummy_analytics)}`),Promise.resolve()}constructor(){e(this,"name","DummyAnalytics")}}class l{initialize(){window.mParticle={config:{rq:[],appVersion:"1.0.0",customFlags:{},identifyRequest:{userIdentities:{customerid:"",email:""}},identityCallback:function(){},isDebug:!0,isDevelopmentMode:!0,isSandbox:!0,sessionTimeout:30,useCookieStorage:!0,useNativeSdk:!1,ready:function(e){window.mParticle.config.rq.push(e)}}};const e=document.createElement("script");e.async=!0,e.src="https://jssdkcdns.mparticle.com/js/v2/us1-a9588c0ddc27594cabd152e47ffe27ee/mparticle.js",document.head.appendChild(e),r.info("MParticleAnalytics initialized")}async trackEvent(e,t){return t?.mparticle&&(r.info(`MParticleAnalytics sending event: ${e} with data: ${JSON.stringify(t.mparticle_analytics)}`),window.mParticle.logEvent(e,1,t.mparticle,{}),window.mParticle.upload()),Promise.resolve()}constructor(){e(this,"name","MParticleAnalytics")}}class d{async initialize(e){this.isInitialized?r.warn("AnalyticsService already initialized"):(await Promise.all(this.analyticsProviders.map((t=>{t.initialize(e),r.info(`AnalyticsService: ${t.name} initialized`)}))),this.isInitialized=!0)}async trackEvent(e,t){r.info(`AnalyticsService.track called with eventName=${e} data=${JSON.stringify(t)}`),await Promise.all(this.analyticsProviders.map((n=>n.trackEvent(e,t))))}constructor(t){e(this,"isInitialized",!1),this.analyticsProviders=t}}class u{getCommonVars(){return{event_timestamp:(new Date).toISOString(),user_agent:window.navigator.userAgent,page_url:window.location.href,page_title:document.title,page_referrer:document.referrer,anonynmous_user_id:n("anonymous_user_id"),session_id:n("session_id")}}getPageVars(){const e=document.querySelector("#page-vars");if(e)try{return JSON.parse(e.innerHTML)}catch(e){return void r.error("Error parsing page-vars")}else r.error("No page-vars found")}getVars(e){const t=this.getCommonVars(),n=this.getPageVars(),i={...n?n.vars:{},...e.vars||{}},s={};for(const n in e.providers){const o=e.providers[n],r={...t};if(o.keys)for(const e of o.keys)Object.prototype.hasOwnProperty.call(i,e)&&(r[e]=i[e]);if(o.extra_keys)for(const e of o.extra_keys)Object.prototype.hasOwnProperty.call(i,e)&&(r[e]=i[e]);if(o.exclude_keys)for(const e of o.exclude_keys)Object.prototype.hasOwnProperty.call(r,e)&&delete r[e];if(o.key_mapping)for(const e in o.key_mapping)if(Object.prototype.hasOwnProperty.call(r,e)){r[o.key_mapping[e]]=r[e],delete r[e]}s[n]=r}return s}}class m{addEventListener(){this.selector.addEventListener(this.name,this.handler.bind(this))}removeEventListener(){this.selector.removeEventListener(this.name,this.handler.bind(this))}getEventConf(e){if(e)try{return JSON.parse(e)}catch(e){return void r.error(`Error parsing eventConf for ${this.name} trigger`)}else r.error(`No eventConf found for ${this.name} trigger`)}constructor(t,n,i){e(this,"triggerVariableParser",new u),this.name=t,this.selector=n,this.analyticsService=i}}class h extends m{handler(e){const t=e?.currentTarget?.dataset?.eventConf,n=this.getEventConf(t);if(n){const e=this.triggerVariableParser.getVars(n);this.analyticsService.trackEvent(n.name,e)}}constructor(e,t){super("click",e,t)}}class p extends m{initialize(){this.shouldEnable&&(this.addEventListener(),this.trackUnload())}handler(e){const t=window.scrollY;t>this.maxDepth&&(this.maxDepth=t)}eventConf(){return{name:"scroll_depth",vars:{max_depth:this.maxDepth,event_method:"pagehide"},providers:{mock_api_analytics:{keys:["max_depth","event_method"]},mparticle:{keys:["max_depth","event_method"]}}}}trackUnload(){window.addEventListener("pagehide",(()=>{this.maxDepth>0&&this.analyticsService.trackEvent("scroll_depth",this.triggerVariableParser.getVars(this.eventConf()))})),window.addEventListener("beforeunload",(()=>{this.maxDepth>0&&this.analyticsService.trackEvent("scroll_depth",this.triggerVariableParser.getVars(this.eventConf()))})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.maxDepth>0&&this.analyticsService.trackEvent("scroll_depth",this.triggerVariableParser.getVars(this.eventConf()))}))}constructor(e,t){super("scroll",window,t),this.maxDepth=0,this.shouldEnable=e}}class g{initialize(){this.bindClickTriggers(),new p(!0,this.analyticsService).initialize()}bindClickTriggers(){const e=document.querySelectorAll('[data-ae-trigger="click"]');Array.from(e).map((e=>new h(e,this.analyticsService))).forEach((e=>e.addEventListener()))}constructor(e){this.analyticsService=e}}var y={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let v;const f=new Uint8Array(16);function w(){if(!v&&(v="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!v))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(f)}const k=[];for(let e=0;e<256;++e)k.push((e+256).toString(16).slice(1));function E(e,t=0){return(k[e[t+0]]+k[e[t+1]]+k[e[t+2]]+k[e[t+3]]+"-"+k[e[t+4]]+k[e[t+5]]+"-"+k[e[t+6]]+k[e[t+7]]+"-"+k[e[t+8]]+k[e[t+9]]+"-"+k[e[t+10]]+k[e[t+11]]+k[e[t+12]]+k[e[t+13]]+k[e[t+14]]+k[e[t+15]]).toLowerCase()}var _=function(e,t,n){if(y.randomUUID&&!t&&!e)return y.randomUUID();const i=(e=e||{}).random||(e.rng||w)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return E(i)};function b(){if(!n("session_id")){t("session_id",_());t("session_count",(parseInt(n("session_count")||"0",10)+1).toString(),{maxAge:2592e3})}}function S(){const e=document.getElementById("cookie-consent-banner"),t=document.getElementById("accept-cookies");"accepted"!==localStorage.getItem("cookie_consent")&&e&&e.classList.remove("hidden"),t&&t.addEventListener("click",(()=>{localStorage.setItem("cookie_consent","accepted"),e&&e.classList.add("hidden")}))}(new class{async initialize(e){const t=new l,n=new a({useSendBeacon:!1}),i=new a({useSendBeacon:!0}),s=new c,o=new d([t,n,i,s]);await o.initialize(e);return new g(o).initialize(),Promise.resolve(o)}}).initialize(),function(){const e=n("anonymous_user_id"),i={maxAge:31536e3};t("anonymous_user_id",e||_(),i)}(),b(),function(){let e=null;function n(){e&&clearTimeout(e),e=setTimeout((()=>{var e;t("session_id","",{maxAge:0,...e||{}}),b()}),18e5)}document.addEventListener("mousemove",n),document.addEventListener("mousedown",n),document.addEventListener("keypress",n),document.addEventListener("touchmove",n),document.addEventListener("scroll",n)}(),function(){const e=document.getElementById("subscription-modal"),i=document.getElementById("show-modal"),s=document.querySelector(".close");if(!e||!i||!s)return;const o=parseInt(n("session_count")||"0",10),r="true"===n("subscribed"),a="true"===n("subscribeModalClosed");i.onclick=()=>{e.style.display="block"},s.onclick=()=>{e.style.display="none",t("subscribeModalClosed","true",{maxAge:86400})},window.onclick=t=>{t.target===e&&(e.style.display="none")},document.getElementById("newsletter-form")?.addEventListener("submit",(n=>{n.preventDefault(),t("subscribed","true",{maxAge:31536e3}),e.style.display="none"})),e.style.display=r||a||1!==o&&5!==o?"none":"block"}(),S(),document.addEventListener("DOMContentLoaded",(()=>{const e=window.location.hash.substring(1),t=decodeURIComponent(e)||"Default Title",n=document.getElementById("story-title");n&&(n.textContent=t)}));
//# sourceMappingURL=index.40de81f8.js.map
