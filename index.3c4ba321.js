function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @module logger
 * @version 0.1.0
 * @author T. Siva <t.siva AT outlook.com>
 * @license MIT
 * @description
 * A simple, flexible, and performant logger for use in the browser.
 *
 * The logger provides a way to output messages with different log levels (DEBUG, INFO, WARN, and ERROR)
 * and allows you to include metadata and a thunk function for lazy evaluation of additional information.
 *
 * Thunk functions are useful in scenarios where computing additional information is computationally
 * expensive or time-consuming. By passing a thunk function, the additional information will only be
 * computed when the log level condition is met, avoiding unnecessary computation and improving
 * performance.
 *
 * Usage example:
 * ```
 * import { Logger, LogLevel } from './utils/logger';
 *
 * const logger = new Logger(LogLevel.DEBUG);
 *
 * logger.debug('Debug message');
 * logger.info('Info message', { metadata: { user: 'John Doe' } });
 * logger.warn('Warning message', { metadata: { errorCode: 123 } });
 * logger.error('Error message', { metadata: { error: new Error('Something went wrong') }, thunk: () => ({ additionalInfo: 'lazy evaluated info' }) });
 * ```
 *
 * Usage example with only thunk (without metadata):
 * ```
 * logger.info('Info message', { thunk: () => ({ user: 'John Doe', action: 'lazy evaluated info' }) });
 * ```
 */
/**
 * @module cookie
 * @author T. Siva <t.siva AT outlook.com>
 * @license MIT
 * @description
 * A simple utility module to handle browser cookies with all possible options.
 *
 * Usage example:
 * ```
 * import { setCookie, getCookie, setSessionCookie } from './cookie';
 *
 * setCookie('name', 'John Doe', { maxAge: 3600, path: '/', secure: true });
 * const name = getCookie('name');
 * setSessionCookie('session', '12345');
 * ```
 */function t(e,t,n){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;n&&(void 0!==n.maxAge&&(i+=`; max-age=${n.maxAge}`),n.path&&(i+=`; path=${n.path}`),n.domain&&(i+=`; domain=${n.domain}`),n.secure&&(i+="; secure"),n.sameSite&&(i+=`; samesite=${n.sameSite}`)),document.cookie=i}function n(e){const t=encodeURIComponent(e)+"=",n=document.cookie.split(";");for(const e of n){const n=e.trim();if(n.startsWith(t))return decodeURIComponent(n.slice(t.length))}return null}let i;var s;(s=i||(i={}))[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR";class r{getLogLevel(){return this.logLevel}debug(e,t){this.log(i.DEBUG,e,t)}info(e,t){this.log(i.INFO,e,t)}warn(e,t){this.log(i.WARN,e,t)}error(e,t){this.log(i.ERROR,e,t)}log(e,t,n){if(e>=this.logLevel){let s;const r=e===i.DEBUG?"debug":e===i.INFO?"info":e===i.WARN?"warn":e===i.ERROR?"error":"info";try{const e=n?.metadata?{metadata:{...n.metadata}}:void 0,t=n?.thunk?{thunk:{...n.thunk()}}:void 0;s=e||t?{...e||{},...t||{}}:void 0}catch(e){console.error("Error while logging message",e)}s?console[r](t,s):console[r](t)}}constructor(e){this.logLevel=e}}const a=function(){let e=i.INFO;const s=function(){const e=new URLSearchParams(window.location.search).get("loglevel");if(e){const t=e.toLowerCase();if("debug"===t)return i.DEBUG;if("info"===t)return i.INFO;if("warn"===t)return i.WARN;if("error"===t)return i.ERROR}}();if(void 0!==s)e=s,function(e){t("session_loglevel",e.toString(),{path:"/",sameSite:"strict"})}(e);else{const t=function(){const e=n("session_loglevel");if(e){const t=parseInt(e);if(i[t])return t}}();void 0!==t&&(e=t)}return new r(e)}();class o{initialize(){a.info("MockApiAnalytics initialized")}async trackEvent(e,t){if(!t?.mock_api_analytics)return Promise.resolve();const n={...t.mock_api_analytics,useSendBeacon:this.useSendBeacon};if(this.useSendBeacon&&navigator.sendBeacon){const t=new Blob([JSON.stringify({eventName:e,data:n})],{type:"text/plain;charset=UTF-8"});return navigator.sendBeacon(`${this.endpoint}`,t)?a.info(`MockApiAnalytics sent event using sendBeacon: ${e} with data: ${JSON.stringify(n)}`):a.error(`MockApiAnalytics failed to send event using sendBeacon: ${e}`),Promise.resolve()}try{a.info(`MockApiAnalytics sending event: ${e} with data: ${JSON.stringify(n)}`);const t=await fetch(`${this.endpoint}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventName:e,data:n})});if(!t.ok)return a.error(`MockApiAnalytics failed to track event: ${t.statusText}`),Promise.resolve()}catch(e){return a.error(`MockApiAnalytics failed to track event: ${e.message}`),Promise.resolve()}}constructor(t){e(this,"name","MockApiAnalytics"),e(this,"endpoint","https://web-experiments.autocode.run/static-web-experiments@dev/"),this.useSendBeacon=!0===t?.useSendBeacon}}class c{initialize(){a.info("DummyAnalytics initialized")}async trackEvent(e,t){return t?.dummy_analytics&&a.info(`DummyAnalytics tracked event: ${e} with data: ${JSON.stringify(t.dummy_analytics)}`),Promise.resolve()}constructor(){e(this,"name","DummyAnalytics")}}class l{initialize(){window.mParticle={config:{rq:[],appVersion:"1.0.0",customFlags:{},identifyRequest:{userIdentities:{customerid:"",email:""}},identityCallback:function(){},isDebug:!0,isDevelopmentMode:!0,isSandbox:!0,sessionTimeout:30,useCookieStorage:!0,useNativeSdk:!1,ready:function(e){window.mParticle.config.rq.push(e)}}};const e=document.createElement("script");e.async=!0,e.src="https://jssdkcdns.mparticle.com/js/v2/us1-a9588c0ddc27594cabd152e47ffe27ee/mparticle.js",document.head.appendChild(e),a.info("MParticleAnalytics initialized")}async trackEvent(e,t){if(t?.mparticle){a.info(`MParticleAnalytics sending event: ${e} with data: ${JSON.stringify(t.mparticle_analytics)}`);const n={...t.mparticle,shouldForceUpload:this.shouldForceUpload};window.mParticle.logEvent(e,1,n,{}),this.shouldForceUpload&&window.mParticle.upload()}return Promise.resolve()}constructor(t){e(this,"name","MParticleAnalytics"),this.shouldForceUpload=!0===t?.shouldForceUpload}}class d{async initialize(e){this.isInitialized?a.warn("AnalyticsService already initialized"):(await Promise.all(this.analyticsProviders.map((t=>{t.initialize(e),a.info(`AnalyticsService: ${t.name} initialized`)}))),this.isInitialized=!0)}async trackEvent(e,t){a.info(`AnalyticsService.track called with eventName=${e} data=${JSON.stringify(t)}`),await Promise.all(this.analyticsProviders.map((n=>n.trackEvent(e,t))))}constructor(t){e(this,"isInitialized",!1),this.analyticsProviders=t}}class h{addEventListener(){this.selector.addEventListener(this.name,this.handler.bind(this))}removeEventListener(){this.selector.removeEventListener(this.name,this.handler.bind(this))}parseEventConf(e){if(e)try{return JSON.parse(e)}catch(e){return void a.error(`Error parsing eventConf for ${this.name} trigger`)}else a.error(`No eventConf found for ${this.name} trigger`)}constructor(e,t,n,i){this.name=e,this.selector=t,this.analyticsService=n,this.eventVariablesParser=i}}class u extends h{handler(e){const t=e?.currentTarget?.dataset?.aeConf,n=this.parseEventConf(t);if(n){const e=this.eventVariablesParser.getVars(n);this.analyticsService.trackEvent(n.name,e)}}constructor(e,t,n){super("click",e,t,n)}}class m extends h{handler(e){const t=e.target.dataset?.aeConf,n=this.parseEventConf(t);if(n){const t=this.eventVariablesParser.getVars(n);this.analyticsService.trackEvent(n.name,t),1===e.intersectionRatio&&this.observer&&(this.observer.unobserve(e.target),this.observer.disconnect())}}addEventListener(){this.selector&&(this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(this.handler(e),this.observer&&this.observer.unobserve(e.target))}))}),{threshold:1}),this.observer.observe(this.selector))}removeEventListener(){this.observer&&this.observer.disconnect()}constructor(e,t,n){super("visibility",e,t,n),this.observer=null}}class v extends h{handler(e){const t=e?.detail;if(t){const e=this.eventVariablesParser.getVars(t);this.analyticsService.trackEvent(t.name,e)}}constructor(e,t,n){super("custom-event",e,t,n)}}class y extends h{initialize(){this.shouldEnable&&(this.addEventListener(),this.trackUnload())}handler(e){const t=window.scrollY;t>this.maxDepth&&(this.maxDepth=t)}eventConf(e){return{name:"scroll_depth",vars:{max_depth:this.maxDepth,event_method:e},providers:{mock_api_analytics:{keys:["max_depth","event_method"]},mparticle:{keys:["max_depth","event_method"]}}}}trackPageLeave(e){"onpagehide"in window?window.addEventListener("pagehide",(t=>{e()})):window.addEventListener("beforeunload",e)}trackUnload(){this.trackPageLeave((()=>{this.analyticsService.trackEvent("scroll_depth",this.eventVariablesParser.getVars(this.eventConf("pageleave")))})),window.addEventListener("pagehide",(()=>{this.analyticsService.trackEvent("scroll_depth",this.eventVariablesParser.getVars(this.eventConf("pagehide")))})),window.addEventListener("beforeunload",(()=>{this.analyticsService.trackEvent("scroll_depth",this.eventVariablesParser.getVars(this.eventConf("beforeunload")))})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.analyticsService.trackEvent("scroll_depth",this.eventVariablesParser.getVars(this.eventConf("visibilitychange")))}))}constructor(e,t,n){super("scroll",window,t,n),this.maxDepth=0,this.shouldEnable=e}}class g{initialize(){this.bindClickTriggers(),new y(!0,this.analyticsService,this.eventVariablesParser).initialize(),this.bindElementVisibleTriggers(),new v(document,this.analyticsService,this.eventVariablesParser).addEventListener()}watchForNewElements(e,t,n,i=!0,s=18e4){let r=!1;const o="string"==typeof e?document.querySelector(e):e;if(!o)return void a.warn(`Could not find parent element for selector: ${e}`);const c=new MutationObserver(((e,s)=>{for(const a of e)if("childList"===a.type&&a.addedNodes.length>0)for(const e of a.addedNodes)if(e instanceof HTMLElement){const a=e.matches(t)?[e]:Array.from(e.querySelectorAll(t));if(a.length>0&&(r=!0,n(a),i)){s.disconnect();break}}}));c.observe(o,{childList:!0,subtree:!0}),setTimeout((()=>{r||(c.disconnect(),a.warn(`Element not found within the specified duration: ${s}ms`))}),s)}bindClickTriggers(){this.bindClickTriggersFor('[data-ae-trigger="click"]'),this.watchForNewElements('[data-ae-observer="single-click"]','[data-ae-trigger="lazy-element-click"]',this.bindClickTriggersFor.bind(this),!0),this.watchForNewElements('[data-ae-observer="multi-click"]','[data-ae-trigger="lazy-element-click"]',this.bindClickTriggersFor.bind(this),!1)}bindClickTriggersFor(e){const t="string"==typeof e?document.querySelectorAll(e):e;Array.from(t).map((e=>new u(e,this.analyticsService,this.eventVariablesParser))).forEach((e=>e.addEventListener()))}bindElementVisibleTriggers(){this.bindElementVisibleTriggersFor('[data-ae-trigger="visible"]'),this.watchForNewElements('[data-ae-observer="single-visible"]','[data-ae-trigger="lazy-element-visible"]',this.bindElementVisibleTriggersFor.bind(this),!0),this.watchForNewElements('[data-ae-observer="multi-visible"]','[data-ae-trigger="lazy-element-visible"]',this.bindElementVisibleTriggersFor.bind(this),!1)}bindElementVisibleTriggersFor(e){const t="string"==typeof e?document.querySelectorAll(e):e;Array.from(t).map((e=>new m(e,this.analyticsService,this.eventVariablesParser))).forEach((e=>e.addEventListener()))}constructor(e,t){this.analyticsService=e,this.eventVariablesParser=t}}const p=Array.prototype.push;class f{initialize(){window.analyticsDataLayer=window.analyticsDataLayer||[],this.resetPush(),window.analyticsDataLayer.forEach((e=>{const{name:t,...n}=e;this.analyticsService.trackEvent(t,this.eventVariablesParser.getVars(n))})),window.addEventListener("analytics-data-layer-update",(e=>{const{name:t,...n}=e.detail;this.analyticsService.trackEvent(t,this.eventVariablesParser.getVars(n))}))}resetPush(){window.analyticsDataLayer.push=function(...e){p.apply(this,e);const t=new CustomEvent("analytics-data-layer-update",{detail:e[0]});window.dispatchEvent(t)}}constructor(e,t){this.analyticsService=e,this.eventVariablesParser=t}}class b{getCommonVars(){return{event_timestamp:(new Date).toISOString(),user_agent:window.navigator.userAgent,page_url:window.location.href,page_title:document.title,page_referrer:document.referrer,anonynmous_user_id:n("anonymous_user_id"),session_id:n("session_id")}}getPageVars(){const e=document.querySelector("#page-vars");if(e)try{return JSON.parse(e.innerHTML)}catch(e){return void a.error("Error parsing page-vars")}else a.error("No page-vars found")}getVars(e){const t=this.getCommonVars(),n=this.pageVars,i={...n?n.vars:{},...e.vars||{}},s={};for(const n in e.providers){const r=e.providers[n],a={...t};if(r.keys)for(const e of r.keys)Object.prototype.hasOwnProperty.call(i,e)&&(a[e]=i[e]);if(r.extra_keys)for(const e of r.extra_keys)Object.prototype.hasOwnProperty.call(i,e)&&(a[e]=i[e]);if(r.exclude_keys)for(const e of r.exclude_keys)Object.prototype.hasOwnProperty.call(a,e)&&delete a[e];if(r.key_mapping)for(const e in r.key_mapping)if(Object.prototype.hasOwnProperty.call(a,e)){a[r.key_mapping[e]]=a[e],delete a[e]}s[n]=a}return s}constructor(){this.pageVars=this.getPageVars()}}var w={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let k;const E=new Uint8Array(16);function A(){if(!k&&(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!k))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(E)}const _=[];for(let e=0;e<256;++e)_.push((e+256).toString(16).slice(1));function S(e,t=0){return(_[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]).toLowerCase()}var L=function(e,t,n){if(w.randomUUID&&!t&&!e)return w.randomUUID();const i=(e=e||{}).random||(e.rng||A)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return S(i)};function P(){if(!n("session_id")){t("session_id",L());t("session_count",(parseInt(n("session_count")||"0",10)+1).toString(),{maxAge:2592e3})}}function C(){const e=document.getElementById("cookie-consent-banner"),t=document.getElementById("accept-cookies");"accepted"!==localStorage.getItem("cookie_consent")&&e&&e.classList.remove("hidden"),t&&t.addEventListener("click",(()=>{localStorage.setItem("cookie_consent","accepted"),e&&e.classList.add("hidden")}))}(new class{async initialize(e){const t=new l({shouldForceUpload:!1}),n=new o({useSendBeacon:!1}),i=new o({useSendBeacon:!0}),s=new c,r=new d([t,n,i,s]);await r.initialize(e);const h=new b;new g(r,h).initialize();return new f(r,h).initialize(),a.info("Analytics initialized"),Promise.resolve(r)}}).initialize(),function(){const e=n("anonymous_user_id"),i={maxAge:31536e3};t("anonymous_user_id",e||L(),i)}(),P(),function(){let e=null;function n(){e&&clearTimeout(e),e=setTimeout((()=>{var e;t("session_id","",{maxAge:0,...e||{}}),P()}),18e5)}document.addEventListener("mousemove",n),document.addEventListener("mousedown",n),document.addEventListener("keypress",n),document.addEventListener("touchmove",n),document.addEventListener("scroll",n)}(),function(){const e=document.getElementById("subscription-modal"),i=document.getElementById("show-modal"),s=document.querySelector(".close");if(!e||!i||!s)return;const r=parseInt(n("session_count")||"0",10),a="true"===n("subscribed"),o="true"===n("subscribeModalClosed");i.onclick=()=>{e.style.display="block"},s.onclick=()=>{e.style.display="none",t("subscribeModalClosed","true",{maxAge:86400})},window.onclick=t=>{t.target===e&&(e.style.display="none")},document.getElementById("newsletter-form")?.addEventListener("submit",(n=>{n.preventDefault(),t("subscribed","true",{maxAge:31536e3}),e.style.display="none"})),e.style.display=a||o||1!==r&&5!==r?"none":"block"}(),C(),document.addEventListener("DOMContentLoaded",(()=>{const e=window.location.hash.substring(1),t=decodeURIComponent(e)||"Default Title",n=document.getElementById("story-title");n&&(n.textContent=t),setTimeout((()=>{const e=document.querySelector(".card-container");if(e){const t=document.createRange().createContextualFragment('<article\n        class="card"\n        data-ae-trigger="lazy-element-visible"\n        data-ae-conf=\'{\n              "name":"element_viewed",\n              "vars": {\n                "key1": "key1_value",\n                "key2": "key2_value",\n                "render_method": "lazy"\n              },\n              "providers": {\n                "dummy_analytics": {\n                  "keys": [\n                    "key1",\n                    "key2",\n                    "render_method"\n                  ],\n                  "extra_keys": [\n                    "page_var1",\n                    "page_var2"\n                  ],\n                  "exclude_keys": [\n                    "common_var1"\n                  ],\n                  "key_mapping": {\n                    "key1": "key1_name",\n                    "key2": "key2_name"\n                  }\n                },\n                "mock_api_analytics": {\n                  "keys": [\n                    "key1",\n                    "key2",\n                    "render_method"\n                  ]\n                }\n              }\n            }\'\n      >\n        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAMLCwgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="News 9" />\n        <h2><a href="story.html#News Article 9">News Article 9</a></h2>\n        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>\n      </article>');e.appendChild(t)}}),2e3)}));
//# sourceMappingURL=index.3c4ba321.js.map
