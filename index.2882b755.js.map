{"mappings":"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","sources":["node_modules/uuid/dist/esm-browser/native.js","node_modules/uuid/dist/esm-browser/rng.js","node_modules/uuid/dist/esm-browser/stringify.js","node_modules/uuid/dist/esm-browser/v4.js","src/set_session_id.ts","src/index.ts","src/analytics/index.ts","src/create_anonymous_user_id.ts"],"sourcesContent":["const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 as uuidv4 } from 'uuid';\n\nfunction setCookie(name: string, value: string, expires: number | null = null, path: string = '/'): void {\n  let cookieString = name + '=' + value + ';';\n\n  if (expires) {\n    const date = new Date();\n    date.setTime(date.getTime() + expires);\n    cookieString += ' expires=' + date.toUTCString() + ';';\n  }\n\n  cookieString += ' path=' + path + ';';\n  document.cookie = cookieString;\n}\n\nfunction getCookie(name: string): string | null {\n  const nameEQ = name + '=';\n  const cookies = document.cookie.split(';');\n\n  for (let i = 0; i < cookies.length; i++) {\n    let cookie = cookies[i];\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1);\n    }\n    if (cookie.indexOf(nameEQ) === 0) {\n      return cookie.substring(nameEQ.length);\n    }\n  }\n  return null;\n}\n\nexport function checkAndSetSessionId(): void {\n  const sessionId = getCookie('session_id');\n  if (!sessionId) {\n    // Generate a new session_id and set the cookie\n    const newSessionId = uuidv4();\n    setCookie('session_id', newSessionId, null);\n    setCookie('last_session_id', newSessionId, 30 * 24 * 60 * 60 * 1000);\n\n    // Increment the sessionCount cookie\n    const sessionCount = parseInt(getCookie('session_count') || '0', 10);\n    const newSessionCount = (sessionCount + 1).toString()\n    setCookie('session_count', newSessionCount, 30 * 24 * 60 * 60 * 1000);\n  } else {\n    // Increment the sessionCount only if the last session_id is different than the current one\n    const lastSessionId = getCookie('last_session_id');\n    if (lastSessionId !== sessionId) {\n      const sessionCount = parseInt(getCookie('session_count') || '0', 10);\n      const newSessionCount = (sessionCount + 1).toString()\n      setCookie('session_count', newSessionCount, 30 * 24 * 60 * 60 * 1000);\n    }\n  }\n}\n\n// Initialize the inactivity timer\nexport function initResetTimeout() {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n\n  function resetTimeout(): void {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(() => {\n      // Save the last_session_id before deleting the session_id\n      const sessionId = getCookie('session_id');\n      if (sessionId) {\n        setCookie('last_session_id', sessionId, 30 * 24 * 60 * 60 * 1000);\n      }\n\n      setCookie('session_id', '', -1); // Delete the session_id cookie\n      checkAndSetSessionId(); // Create a new session_id after the old one has been deleted\n    }, 30 * 60 * 1000); // 30 minutes\n  }\n\n  // Listen for user activity events to reset the timeout\n  document.addEventListener('mousemove', resetTimeout);\n  document.addEventListener('mousedown', resetTimeout);\n  document.addEventListener('keypress', resetTimeout);\n  document.addEventListener('touchmove', resetTimeout);\n  document.addEventListener('scroll', resetTimeout);\n}\n","import { YourAnalyticsClass } from './analytics';\nimport { checkAndSetAnonymousId } from './create_anonymous_user_id';\nimport { checkAndSetSessionId, initResetTimeout } from './set_session_id';\n\nconst analytics = new YourAnalyticsClass();\n\ncheckAndSetAnonymousId();\ncheckAndSetSessionId();\ninitResetTimeout();\n\nfunction setCookie(name: string, value: string, days: number): void {\n  const date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  const expires = '; expires=' + date.toUTCString();\n  document.cookie = name + '=' + value + expires + '; path=/';\n}\n\nfunction getCookie(name: string): string | null {\n  const nameWithEq = name + '=';\n  const decodedCookie = decodeURIComponent(document.cookie);\n  const cookieArray = decodedCookie.split(';');\n\n  for (let cookie of cookieArray) {\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1);\n    }\n    if (cookie.indexOf(nameWithEq) === 0) {\n      return cookie.substring(nameWithEq.length, cookie.length);\n    }\n  }\n  return null;\n}\n\nfunction initModal() {\n  const modal = document.getElementById('subscription-modal') as HTMLElement;\n  const showModalButton = document.getElementById('show-modal') as HTMLButtonElement;\n  const closeButton = document.querySelector('.close') as HTMLElement;\n\n  if (!modal || !showModalButton || !closeButton) {\n    return;\n  }\n\n  const sessionCount = parseInt(getCookie('session_count') || '0', 10);\n  const subscribed = getCookie('subscribed') === 'true';\n\n  showModalButton.onclick = () => {\n    modal.style.display = 'block';\n  };\n\n  closeButton.onclick = () => {\n    modal.style.display = 'none';\n  };\n\n  window.onclick = (event: MouseEvent) => {\n    if (event.target === modal) {\n      modal.style.display = 'none';\n    }\n  };\n\n  // Replace this with your actual newsletter form submission event\n  document.getElementById('newsletter-form')?.addEventListener('submit', (e) => {\n    e.preventDefault();\n    setCookie('subscribed', 'true', 365);\n    modal.style.display = 'none';\n  });\n\n  // Show the modal only for 1st and 5th visit, and if the user has not subscribed\n  if (!subscribed && (sessionCount === 1 || sessionCount === 5)) {\n    modal.style.display = 'block';\n  } else {\n    modal.style.display = 'none';\n  }\n}\n\ninitModal();\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // const urlParams = new URLSearchParams(window.location.search);\n  // const title = urlParams.get('title') || 'Default Title';\n  const hash = window.location.hash.substring(1); // Remove the leading #\n  const decodedHash = decodeURIComponent(hash);\n  const title = decodedHash || 'Default Title';\n\n  const storyTitleElement = document.getElementById('story-title');\n  if (storyTitleElement) {\n    storyTitleElement.textContent = title;\n  }\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const consentBanner = document.getElementById('cookie-consent-banner');\n  const acceptCookiesBtn = document.getElementById('accept-cookies');\n\n  function checkCookieConsent(): boolean {\n    const consentValue = localStorage.getItem('cookie_consent');\n    return consentValue === 'accepted';\n  }\n\n  function acceptCookieConsent(): void {\n    localStorage.setItem('cookie_consent', 'accepted');\n    if (consentBanner) {\n      consentBanner.classList.add('hidden');\n    }\n  }\n\n  if (!checkCookieConsent() && consentBanner) {\n    consentBanner.classList.remove('hidden');\n  }\n\n  if (acceptCookiesBtn) {\n    acceptCookiesBtn.addEventListener('click', () => {\n      acceptCookieConsent();\n    });\n  }\n});\n","export class YourAnalyticsClass {\n  constructor() {\n    // Your constructor logic here\n  }\n\n  public trackEvent(event: string): void {\n    console.log(`Tracking event: ${event}`);\n    // Your tracking logic here\n  }\n}\n","import { v4 as uuidv4 } from 'uuid';\n\nfunction setCookie(name: string, value: string, days: number): void {\n  const date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  const expires = '; expires=' + date.toUTCString();\n  document.cookie = name + '=' + value + expires + '; path=/';\n}\n\nfunction getCookie(name: string): string | null {\n  const nameEQ = name + '=';\n  const cookies = document.cookie.split(';');\n\n  for (let i = 0; i < cookies.length; i++) {\n    let cookie = cookies[i];\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1);\n    }\n    if (cookie.indexOf(nameEQ) === 0) {\n      return cookie.substring(nameEQ.length);\n    }\n  }\n  return null;\n}\n\nexport function checkAndSetAnonymousId(): void {\n  const anonymousId = getCookie('anonymous_user_id');\n  if (!anonymousId) {\n    setCookie('anonymous_user_id', uuidv4(), 365);\n  }\n}\n"],"names":["$37f105a7b9674789$export$2e2bcd8739ae039","crypto","randomUUID","bind","$1ac7e0985a17c228$var$getRandomValues","$1ac7e0985a17c228$var$rnds8","Uint8Array","$1ac7e0985a17c228$export$2e2bcd8739ae039","getRandomValues","Error","$bd59f5a7d9c833e9$var$byteToHex","i","push","toString","slice","$bd59f5a7d9c833e9$export$8fb373d660548968","arr","offset","toLowerCase","$e3a4bb9406254d13$export$2e2bcd8739ae039","options","buf","rnds","random","rng","$a67b2f67da0a1be2$var$setCookie","name","value","expires","path","cookieString","date","Date","setTime","getTime","toUTCString","document","cookie","$a67b2f67da0a1be2$var$getCookie","nameEQ","cookies","split","length","charAt","substring","indexOf","$a67b2f67da0a1be2$export$1cbd0a6d0e35dd33","sessionId","parseInt","newSessionId","trackEvent","event","console","log","constructor","$62c72e5241014c60$var$getCookie","nameWithEq","cookieArray","decodeURIComponent","$e96cbcc8fe438ae9$var$getCookie","days","$e96cbcc8fe438ae9$var$setCookie","timeout","resetTimeout","clearTimeout","setTimeout","addEventListener","modal","getElementById","showModalButton","closeButton","querySelector","sessionCount","subscribed","onclick","style","display","window","target","e","preventDefault","$62c72e5241014c60$var$setCookie","$62c72e5241014c60$var$initModal","hash","location","title","storyTitleElement","textContent","consentBanner","acceptCookiesBtn","localStorage","getItem","classList","remove","setItem","add"],"version":3,"file":"index.2882b755.js.map"}